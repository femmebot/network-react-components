{"code":"import * as tslib_1 from \"tslib\";\r\nimport { getModelType, initModelRef, ReferenceType, updateModel, } from 'datx';\r\nimport { mapItems } from 'datx-utils';\r\nimport { clearAllCache, clearCacheByType } from './cache';\r\nimport { URL_REGEX } from './consts';\r\nimport { ParamArrayType } from './enums/ParamArrayType';\r\nimport { GenericModel } from './GenericModel';\r\nimport { flattenModel, removeModel } from './helpers/model';\r\nimport { getValue } from './helpers/utils';\r\nimport { config, fetch, read } from './NetworkUtils';\r\nexport function decorateCollection(BaseClass) {\r\n    var JsonapiCollection = /** @class */ (function (_super) {\r\n        tslib_1.__extends(JsonapiCollection, _super);\r\n        function JsonapiCollection() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        JsonapiCollection.prototype.sync = function (body) {\r\n            var _this = this;\r\n            if (!body) {\r\n                return null;\r\n            }\r\n            var data = this.__iterateEntries(body, function (obj) { return _this.__addRecord(obj); });\r\n            this.__iterateEntries(body, this.__updateRelationships.bind(this));\r\n            return data;\r\n        };\r\n        /**\r\n         * Fetch the records with the given type and id\r\n         *\r\n         * @param {string} type Record type\r\n         * @param {number|string} type Record id\r\n         * @param {IRequestOptions} [options] Server options\r\n         * @returns {Promise<Response>} Resolves with the Response object or rejects with an error\r\n         */\r\n        JsonapiCollection.prototype.fetch = function (type, id, options) {\r\n            var _this = this;\r\n            var modelType = getModelType(type);\r\n            var query = this.__prepareQuery(modelType, id, undefined, options);\r\n            return read(query.url, this, query.headers, options)\r\n                .then(function (res) { return _this.__handleErrors(res); });\r\n        };\r\n        /**\r\n         * Fetch the first page of records of the given type\r\n         *\r\n         * @param {string} type Record type\r\n         * @param {IRequestOptions} [options] Server options\r\n         * @returns {Promise<Response>} Resolves with the Response object or rejects with an error\r\n         */\r\n        JsonapiCollection.prototype.fetchAll = function (type, options) {\r\n            var _this = this;\r\n            var modelType = getModelType(type);\r\n            var query = this.__prepareQuery(modelType, undefined, undefined, options);\r\n            return read(query.url, this, query.headers, options)\r\n                .then(function (res) { return _this.__handleErrors(res); });\r\n        };\r\n        JsonapiCollection.prototype.request = function (url, method, data, options) {\r\n            if (method === void 0) { method = 'GET'; }\r\n            var query = this.__buildUrl(url, data, options);\r\n            return fetch({ url: query.url, options: options, data: data, method: method, collection: this });\r\n        };\r\n        JsonapiCollection.prototype.remove = function (obj, id, remote) {\r\n            var remove = (typeof id === 'boolean' || typeof id === 'object') ? id : remote;\r\n            var modelId = (typeof id !== 'boolean' && typeof id !== 'object') ? id : undefined;\r\n            var type = getModelType(obj);\r\n            var model = this.find(type, modelId);\r\n            if (model && remove) {\r\n                return removeModel(model, typeof remove === 'object' ? remove : undefined);\r\n            }\r\n            if (model) {\r\n                _super.prototype.remove.call(this, model);\r\n            }\r\n            return Promise.resolve();\r\n        };\r\n        JsonapiCollection.prototype.removeAll = function (type) {\r\n            _super.prototype.removeAll.call(this, type);\r\n            clearCacheByType(getModelType(type));\r\n        };\r\n        JsonapiCollection.prototype.reset = function () {\r\n            _super.prototype.reset.call(this);\r\n            clearAllCache();\r\n        };\r\n        /**\r\n         * Function used to handle response errors\r\n         *\r\n         * @private\r\n         * @param {Response} response API response\r\n         * @returns API response\r\n         */\r\n        JsonapiCollection.prototype.__handleErrors = function (response) {\r\n            if (response.error) {\r\n                throw response.error;\r\n            }\r\n            return response;\r\n        };\r\n        JsonapiCollection.prototype.__addRecord = function (obj) {\r\n            var staticCollection = this.constructor;\r\n            var type = obj.type, id = obj.id;\r\n            var record = this.find(type, id);\r\n            var flattened = flattenModel(obj);\r\n            if (record) {\r\n                updateModel(record, flattened);\r\n            }\r\n            else if (staticCollection.types.filter(function (item) { return item.type === type; }).length) {\r\n                record = this.add(flattened, type);\r\n            }\r\n            else {\r\n                record = this.add(new GenericModel(flattened));\r\n            }\r\n            return record;\r\n        };\r\n        JsonapiCollection.prototype.__updateRelationships = function (obj) {\r\n            var _this = this;\r\n            var record = this.find(obj.type, obj.id);\r\n            var refs = obj.relationships ? Object.keys(obj.relationships) : [];\r\n            refs.forEach(function (ref) {\r\n                var items = obj.relationships[ref].data;\r\n                if (items instanceof Array && items.length < 1) {\r\n                    // it's only possible to update items with one ore more refs. Early exit\r\n                    return;\r\n                }\r\n                if (items && record) {\r\n                    var models = mapItems(items, function (def) { return _this.find(def.type, def.id) || def.id; }) || null;\r\n                    var itemType = items instanceof Array ? items[0].type : items.type;\r\n                    if (ref in record) {\r\n                        record[ref] = models;\r\n                    }\r\n                    else {\r\n                        initModelRef(record, ref, { model: itemType, type: ReferenceType.TO_ONE_OR_MANY }, models);\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        JsonapiCollection.prototype.__iterateEntries = function (body, fn) {\r\n            mapItems((body && body.included) || [], fn);\r\n            return mapItems((body && body.data) || [], fn);\r\n        };\r\n        JsonapiCollection.prototype.__prepareQuery = function (type, id, data, options) {\r\n            var staticCollection = this.constructor;\r\n            var model = staticCollection.types.filter(function (item) { return item.type === type; })[0];\r\n            var path = model\r\n                ? (getValue(model['endpoint']) || model['baseUrl'] || getModelType(model))\r\n                : type;\r\n            var url = id ? path + \"/\" + id : \"\" + path;\r\n            return this.__buildUrl(url, data, options);\r\n        };\r\n        JsonapiCollection.prototype.__buildUrl = function (url, data, options) {\r\n            var headers = (options && options.headers) || {};\r\n            var params = this.__prepareFilters((options && options.filter) || {}).concat(this.__prepareSort(options && options.sort), this.__prepareIncludes(options && options.include), this.__prepareFields((options && options.fields) || {}), this.__prepareRawParams((options && options.params) || []));\r\n            var baseUrl = this.__appendParams(this.__prefixUrl(url), params);\r\n            return { data: data, headers: headers, url: baseUrl };\r\n        };\r\n        JsonapiCollection.prototype.__prepareFilters = function (filters) {\r\n            return this.__parametrize(filters).map(function (item) { return \"filter[\" + item.key + \"]=\" + item.value; });\r\n        };\r\n        JsonapiCollection.prototype.__prepareSort = function (sort) {\r\n            return sort ? [\"sort=\" + sort] : [];\r\n        };\r\n        JsonapiCollection.prototype.__prepareIncludes = function (include) {\r\n            return include ? [\"include=\" + include] : [];\r\n        };\r\n        JsonapiCollection.prototype.__prepareFields = function (fields) {\r\n            var list = [];\r\n            Object.keys(fields).forEach(function (key) {\r\n                list.push(\"fields[\" + key + \"]=\" + fields[key]);\r\n            });\r\n            return list;\r\n        };\r\n        JsonapiCollection.prototype.__prepareRawParams = function (params) {\r\n            return params.map(function (param) {\r\n                if (typeof param === 'string') {\r\n                    return param;\r\n                }\r\n                return param.key + \"=\" + param.value;\r\n            });\r\n        };\r\n        JsonapiCollection.prototype.__prefixUrl = function (url) {\r\n            if (URL_REGEX.test(url)) {\r\n                return url;\r\n            }\r\n            return \"\" + config.baseUrl + url;\r\n        };\r\n        JsonapiCollection.prototype.__appendParams = function (url, params) {\r\n            if (params.length) {\r\n                var separator = url.indexOf('?') === -1 ? '?' : '&';\r\n                url += separator + params.join('&');\r\n            }\r\n            return url;\r\n        };\r\n        JsonapiCollection.prototype.__parametrize = function (params, scope) {\r\n            var _this = this;\r\n            if (scope === void 0) { scope = ''; }\r\n            var list = [];\r\n            Object.keys(params).forEach(function (key) {\r\n                if (params[key] instanceof Array) {\r\n                    if (config.paramArrayType === ParamArrayType.OBJECT_PATH) {\r\n                        list.push.apply(list, _this.__parametrize(params[key], key + \".\"));\r\n                    }\r\n                    else if (config.paramArrayType === ParamArrayType.COMMA_SEPARATED) {\r\n                        list.push({ key: \"\" + scope + key, value: params[key].join(',') });\r\n                    }\r\n                    else if (config.paramArrayType === ParamArrayType.MULTIPLE_PARAMS) {\r\n                        list.push.apply(list, params[key].map(function (param) { return ({ key: \"\" + scope + key, value: param }); }));\r\n                    }\r\n                    else if (config.paramArrayType === ParamArrayType.PARAM_ARRAY) {\r\n                        list.push.apply(list, params[key].map(function (param) { return ({ key: \"\" + scope + key + \"][\", value: param }); }));\r\n                    }\r\n                }\r\n                else if (typeof params[key] === 'object') {\r\n                    list.push.apply(list, _this.__parametrize(params[key], key + \".\"));\r\n                }\r\n                else {\r\n                    list.push({ key: \"\" + scope + key, value: params[key] });\r\n                }\r\n            });\r\n            return list;\r\n        };\r\n        JsonapiCollection.types = (BaseClass.types && BaseClass.types.length)\r\n            ? BaseClass.types.concat(GenericModel)\r\n            : [GenericModel];\r\n        JsonapiCollection.cache = BaseClass['cache'] === undefined\r\n            ? typeof window !== 'undefined'\r\n            : BaseClass['cache'];\r\n        JsonapiCollection.defaultModel = BaseClass['defaultModel'] || GenericModel;\r\n        return JsonapiCollection;\r\n    }(BaseClass));\r\n    return JsonapiCollection;\r\n}\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVjb3JhdGVDb2xsZWN0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3JjL2RlY29yYXRlQ29sbGVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUNMLFlBQVksRUFJWixZQUFZLEVBSVosYUFBYSxFQUNiLFdBQVcsR0FDWixNQUFNLE1BQU0sQ0FBQztBQUNkLE9BQU8sRUFBeUIsUUFBUSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRTVELE9BQU8sRUFBQyxhQUFhLEVBQUUsZ0JBQWdCLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDeEQsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNuQyxPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sd0JBQXdCLENBQUM7QUFDdEQsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzVDLE9BQU8sRUFBQyxZQUFZLEVBQUUsV0FBVyxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDMUQsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBUXpDLE9BQU8sRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBS25ELE1BQU0sNkJBQTZCLFNBQWdDO0lBRWpFO1FBQWdDLDZDQUFTO1FBQXpDOztRQXlRQSxDQUFDO1FBN1BRLGdDQUFJLEdBQVgsVUFBcUQsSUFBZ0I7WUFBckUsaUJBT0M7WUFOQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ1YsTUFBTSxDQUFDLElBQUksQ0FBQztZQUNkLENBQUM7WUFDRCxJQUFNLElBQUksR0FBb0IsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxVQUFDLEdBQVksSUFBSyxPQUFBLEtBQUksQ0FBQyxXQUFXLENBQUksR0FBRyxDQUFDLEVBQXhCLENBQXdCLENBQUMsQ0FBQztZQUN0RyxJQUFJLENBQUMsZ0JB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bnRlbnQiOlsiaW1wb3J0IHtcbiAgZ2V0TW9kZWxUeXBlLFxuICBJQ29sbGVjdGlvbkNvbnN0cnVjdG9yLFxuICBJSWRlbnRpZmllcixcbiAgSU1vZGVsQ29uc3RydWN0b3IsXG4gIGluaXRNb2RlbFJlZixcbiAgSVR5cGUsXG4gIFB1cmVDb2xsZWN0aW9uLFxuICBQdXJlTW9kZWwsXG4gIFJlZmVyZW5jZVR5cGUsXG4gIHVwZGF0ZU1vZGVsLFxufSBmcm9tICdkYXR4JztcbmltcG9ydCB7SURpY3Rpb25hcnksIElSYXdNb2RlbCwgbWFwSXRlbXN9IGZyb20gJ2RhdHgtdXRpbHMnO1xuXG5pbXBvcnQge2NsZWFyQWxsQ2FjaGUsIGNsZWFyQ2FjaGVCeVR5cGV9IGZyb20gJy4vY2FjaGUnO1xuaW1wb3J0IHtVUkxfUkVHRVh9IGZyb20gJy4vY29uc3RzJztcbmltcG9ydCB7UGFyYW1BcnJheVR5cGV9IGZyb20gJy4vZW51bXMvUGFyYW1BcnJheVR5cGUnO1xuaW1wb3J0IHtHZW5lcmljTW9kZWx9IGZyb20gJy4vR2VuZXJpY01vZGVsJztcbmltcG9ydCB7ZmxhdHRlbk1vZGVsLCByZW1vdmVNb2RlbH0gZnJvbSAnLi9oZWxwZXJzL21vZGVsJztcbmltcG9ydCB7Z2V0VmFsdWV9IGZyb20gJy4vaGVscGVycy91dGlscyc7XG5pbXBvcnQge0lGaWx0ZXJzfSBmcm9tICcuL2ludGVyZmFjZXMvSUZpbHRlcnMnO1xuaW1wb3J0IHtJSGVhZGVyc30gZnJvbSAnLi9pbnRlcmZhY2VzL0lIZWFkZXJzJztcbmltcG9ydCB7SUpzb25hcGlDb2xsZWN0aW9ufSBmcm9tICcuL2ludGVyZmFjZXMvSUpzb25hcGlDb2xsZWN0aW9uJztcbmltcG9ydCB7SUpzb25hcGlNb2RlbH0gZnJvbSAnLi9pbnRlcmZhY2VzL0lKc29uYXBpTW9kZWwnO1xuaW1wb3J0IHtJUmVxdWVzdE9wdGlvbnN9IGZyb20gJy4vaW50ZXJmYWNlcy9JUmVxdWVzdE9wdGlvbnMnO1xuaW1wb3J0IHtJRGVmaW5pdGlvbiwgSVJlbGF0aW9uc2hpcCwgSVJlcXVlc3R9IGZyb20gJy4vaW50ZXJmYWNlcy9Kc29uQXBpJztcbmltcG9ydCB7SVJlY29yZCwgSVJlc3BvbnNlfSBmcm9tICcuL2ludGVyZmFjZXMvSnNvbkFwaSc7XG5pbXBvcnQge2NvbmZpZywgZmV0Y2gsIHJlYWR9IGZyb20gJy4vTmV0d29ya1V0aWxzJztcbmltcG9ydCB7UmVzcG9uc2V9IGZyb20gJy4vUmVzcG9uc2UnO1xuXG5kZWNsYXJlIHZhciB3aW5kb3c6IG9iamVjdHx1bmRlZmluZWQ7XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvcmF0ZUNvbGxlY3Rpb24oQmFzZUNsYXNzOiB0eXBlb2YgUHVyZUNvbGxlY3Rpb24pIHtcblxuICBjbGFzcyBKc29uYXBpQ29sbGVjdGlvbiBleHRlbmRzIEJhc2VDbGFzcyB7XG5cbiAgICBwdWJsaWMgc3RhdGljIHR5cGVzID0gKEJhc2VDbGFzcy50eXBlcyAmJiBCYXNlQ2xhc3MudHlwZXMubGVuZ3RoKVxuICAgICAgPyBCYXNlQ2xhc3MudHlwZXMuY29uY2F0KEdlbmVyaWNNb2RlbClcbiAgICAgIDogW0dlbmVyaWNNb2RlbF07XG5cbiAgICBwdWJsaWMgc3RhdGljIGNhY2hlOiBib29sZWFuID0gQmFzZUNsYXNzWydjYWNoZSddID09PSB1bmRlZmluZWRcbiAgICAgID8gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgIDogQmFzZUNsYXNzWydjYWNoZSddO1xuXG4gICAgcHVibGljIHN0YXRpYyBkZWZhdWx0TW9kZWwgPSBCYXNlQ2xhc3NbJ2RlZmF1bHRNb2RlbCddIHx8IEdlbmVyaWNNb2RlbDtcblxuICAgIHB1YmxpYyBzeW5jPFQgZXh0ZW5kcyBJSnNvbmFwaU1vZGVsID0gSUpzb25hcGlNb2RlbD4oYm9keT86IElSZXNwb25zZSk6IFR8QXJyYXk8VD58bnVsbCB7XG4gICAgICBpZiAoIWJvZHkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhOiBUfEFycmF5PFQ+fG51bGwgPSB0aGlzLl9faXRlcmF0ZUVudHJpZXMoYm9keSwgKG9iajogSVJlY29yZCkgPT4gdGhpcy5fX2FkZFJlY29yZDxUPihvYmopKTtcbiAgICAgIHRoaXMuX19pdGVyYXRlRW50cmllcyhib2R5LCB0aGlzLl9fdXBkYXRlUmVsYXRpb25zaGlwcy5iaW5kKHRoaXMpKTtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZldGNoIHRoZSByZWNvcmRzIHdpdGggdGhlIGdpdmVuIHR5cGUgYW5kIGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBSZWNvcmQgdHlwZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdHlwZSBSZWNvcmQgaWRcbiAgICAgKiBAcGFyYW0ge0lSZXF1ZXN0T3B0aW9uc30gW29wdGlvbnNdIFNlcnZlciBvcHRpb25zXG4gICAgICogQHJldHVybnMge1Byb21pc2U8UmVzcG9uc2U+fSBSZXNvbHZlcyB3aXRoIHRoZSBSZXNwb25zZSBvYmplY3Qgb3IgcmVqZWN0cyB3aXRoIGFuIGVycm9yXG4gICAgICovXG4gICAgcHVibGljIGZldGNoPFQgZXh0ZW5kcyBJSnNvbmFwaU1vZGVsID0gSUpzb25hcGlNb2RlbD4oXG4gICAgICB0eXBlOiBJVHlwZXxJTW9kZWxDb25zdHJ1Y3RvcjxUPixcbiAgICAgIGlkOiBudW1iZXJ8c3RyaW5nLFxuICAgICAgb3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgICApOiBQcm9taXNlPFJlc3BvbnNlPFQ+PiB7XG4gICAgICBjb25zdCBtb2RlbFR5cGUgPSBnZXRNb2RlbFR5cGUodHlwZSk7XG4gICAgICBjb25zdCBxdWVyeSA9IHRoaXMuX19wcmVwYXJlUXVlcnkobW9kZWxUeXBlLCBpZCwgdW5kZWZpbmVkLCBvcHRpb25zKTtcbiAgICAgIHJldHVybiByZWFkPFQ+KHF1ZXJ5LnVybCwgdGhpcywgcXVlcnkuaGVhZGVycywgb3B0aW9ucylcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fX2hhbmRsZUVycm9yczxUPihyZXMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaCB0aGUgZmlyc3QgcGFnZSBvZiByZWNvcmRzIG9mIHRoZSBnaXZlbiB0eXBlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBSZWNvcmQgdHlwZVxuICAgICAqIEBwYXJhbSB7SVJlcXVlc3RPcHRpb25zfSBbb3B0aW9uc10gU2VydmVyIG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxSZXNwb25zZT59IFJlc29sdmVzIHdpdGggdGhlIFJlc3BvbnNlIG9iamVjdCBvciByZWplY3RzIHdpdGggYW4gZXJyb3JcbiAgICAgKi9cbiAgICBwdWJsaWMgZmV0Y2hBbGw8VCBleHRlbmRzIElKc29uYXBpTW9kZWwgPSBJSnNvbmFwaU1vZGVsPihcbiAgICAgIHR5cGU6IElUeXBlfElNb2RlbENvbnN0cnVjdG9yPFQ+LFxuICAgICAgb3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgICApOiBQcm9taXNlPFJlc3BvbnNlPFQ+PiB7XG4gICAgICBjb25zdCBtb2RlbFR5cGUgPSBnZXRNb2RlbFR5cGUodHlwZSk7XG4gICAgICBjb25zdCBxdWVyeSA9IHRoaXMuX19wcmVwYXJlUXVlcnkobW9kZWxUeXBlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgb3B0aW9ucyk7XG4gICAgICByZXR1cm4gcmVhZDxUPihxdWVyeS51cmwsIHRoaXMsIHF1ZXJ5LmhlYWRlcnMsIG9wdGlvbnMpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX19oYW5kbGVFcnJvcnM8VD4ocmVzKSk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlcXVlc3Q8VCBleHRlbmRzIElKc29uYXBpTW9kZWwgPSBJSnNvbmFwaU1vZGVsPihcbiAgICAgIHVybDogc3RyaW5nLFxuICAgICAgbWV0aG9kOiBzdHJpbmcgPSAnR0VUJyxcbiAgICAgIGRhdGE/OiBvYmplY3QsXG4gICAgICBvcHRpb25zPzogSVJlcXVlc3RPcHRpb25zLFxuICAgICk6IFByb21pc2U8UmVzcG9uc2U8VD4+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5fX2J1aWxkVXJsKHVybCwgZGF0YSwgb3B0aW9ucyk7XG4gICAgICByZXR1cm4gZmV0Y2g8VD4oe3VybDogcXVlcnkudXJsLCBvcHRpb25zLCBkYXRhLCBtZXRob2QsIGNvbGxlY3Rpb246IHRoaXN9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVtb3ZlKHR5cGU6IElUeXBlfHR5cGVvZiBQdXJlTW9kZWwsIGlkPzogSUlkZW50aWZpZXIsIHJlbW90ZT86IGJvb2xlYW58SVJlcXVlc3RPcHRpb25zKTtcbiAgICBwdWJsaWMgcmVtb3ZlKG1vZGVsOiBQdXJlTW9kZWwsIHJlbW90ZT86IGJvb2xlYW58SVJlcXVlc3RPcHRpb25zKTtcbiAgICBwdWJsaWMgcmVtb3ZlKFxuICAgICAgb2JqOiBJVHlwZXx0eXBlb2YgUHVyZU1vZGVsfFB1cmVNb2RlbCxcbiAgICAgIGlkPzogSUlkZW50aWZpZXJ8Ym9vbGVhbnxJUmVxdWVzdE9wdGlvbnMsXG4gICAgICByZW1vdGU/OiBib29sZWFufElSZXF1ZXN0T3B0aW9ucyxcbiAgICApIHtcbiAgICAgIGNvbnN0IHJlbW92ZSA9ICh0eXBlb2YgaWQgPT09ICdib29sZWFuJyB8fCB0eXBlb2YgaWQgPT09ICdvYmplY3QnKSA/IGlkIDogcmVtb3RlO1xuICAgICAgY29uc3QgbW9kZWxJZCA9ICh0eXBlb2YgaWQgIT09ICdib29sZWFuJyAmJiB0eXBlb2YgaWQgIT09ICdvYmplY3QnKSA/IGlkIDogdW5kZWZpbmVkO1xuICAgICAgY29uc3QgdHlwZSA9IGdldE1vZGVsVHlwZShvYmopO1xuICAgICAgY29uc3QgbW9kZWwgPSB0aGlzLmZpbmQodHlwZSwgbW9kZWxJZCk7XG5cbiAgICAgIGlmIChtb2RlbCAmJiByZW1vdmUpIHtcbiAgICAgICAgcmV0dXJuIHJlbW92ZU1vZGVsKG1vZGVsLCB0eXBlb2YgcmVtb3ZlID09PSAnb2JqZWN0JyA/IHJlbW92ZSA6IHVuZGVmaW5lZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb2RlbCkge1xuICAgICAgICBzdXBlci5yZW1vdmUobW9kZWwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyByZW1vdmVBbGwodHlwZTogc3RyaW5nIHwgbnVtYmVyIHwgdHlwZW9mIFB1cmVNb2RlbCkge1xuICAgICAgc3VwZXIucmVtb3ZlQWxsKHR5cGUpO1xuICAgICAgY2xlYXJDYWNoZUJ5VHlwZShnZXRNb2RlbFR5cGUodHlwZSkpO1xuICAgIH1cblxuICAgIHB1YmxpYyByZXNldCgpIHtcbiAgICAgIHN1cGVyLnJlc2V0KCk7XG4gICAgICBjbGVhckFsbENhY2hlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdXNlZCB0byBoYW5kbGUgcmVzcG9uc2UgZXJyb3JzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UmVzcG9uc2V9IHJlc3BvbnNlIEFQSSByZXNwb25zZVxuICAgICAqIEByZXR1cm5zIEFQSSByZXNwb25zZVxuICAgICAqL1xuICAgIHByaXZhdGUgX19oYW5kbGVFcnJvcnM8VCBleHRlbmRzIElKc29uYXBpTW9kZWw+KHJlc3BvbnNlOiBSZXNwb25zZTxUPikge1xuICAgICAgaWYgKHJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgIHRocm93IHJlc3BvbnNlLmVycm9yO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfX2FkZFJlY29yZDxUIGV4dGVuZHMgSUpzb25hcGlNb2RlbCA9IElKc29uYXBpTW9kZWw+KG9iajogSVJlY29yZCk6IFQge1xuICAgICAgY29uc3Qgc3RhdGljQ29sbGVjdGlvbiA9IHRoaXMuY29uc3RydWN0b3IgYXMgdHlwZW9mIFB1cmVDb2xsZWN0aW9uO1xuICAgICAgY29uc3Qge3R5cGUsIGlkfSA9IG9iajtcbiAgICAgIGxldCByZWNvcmQ6IFR8bnVsbCA9IHRoaXMuZmluZCh0eXBlLCBpZCkgYXMgVHxudWxsO1xuICAgICAgY29uc3QgZmxhdHRlbmVkOiBJUmF3TW9kZWwgPSBmbGF0dGVuTW9kZWwob2JqKTtcblxuICAgICAgaWYgKHJlY29yZCkge1xuICAgICAgICB1cGRhdGVNb2RlbChyZWNvcmQsIGZsYXR0ZW5lZCk7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRpY0NvbGxlY3Rpb24udHlwZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnR5cGUgPT09IHR5cGUpLmxlbmd0aCkge1xuICAgICAgICByZWNvcmQgPSB0aGlzLmFkZChmbGF0dGVuZWQsIHR5cGUpIGFzIFQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWNvcmQgPSB0aGlzLmFkZChuZXcgR2VuZXJpY01vZGVsKGZsYXR0ZW5lZCkpIGFzIFQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfX3VwZGF0ZVJlbGF0aW9uc2hpcHMob2JqOiBJUmVjb3JkKTogdm9pZCB7XG4gICAgICBjb25zdCByZWNvcmQ6IFB1cmVNb2RlbHxudWxsID0gdGhpcy5maW5kKG9iai50eXBlLCBvYmouaWQpO1xuICAgICAgY29uc3QgcmVmczogQXJyYXk8c3RyaW5nPiA9IG9iai5yZWxhdGlvbnNoaXBzID8gT2JqZWN0LmtleXMob2JqLnJlbGF0aW9uc2hpcHMpIDogW107XG4gICAgICByZWZzLmZvckVhY2goKHJlZjogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gKG9iai5yZWxhdGlvbnNoaXBzIGFzIElEaWN0aW9uYXJ5PElSZWxhdGlvbnNoaXA+KVtyZWZdLmRhdGE7XG4gICAgICAgIGlmIChpdGVtcyBpbnN0YW5jZW9mIEFycmF5ICYmIGl0ZW1zLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAvLyBpdCdzIG9ubHkgcG9zc2libGUgdG8gdXBkYXRlIGl0ZW1zIHdpdGggb25lIG9yZSBtb3JlIHJlZnMuIEVhcmx5IGV4aXRcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW1zICYmIHJlY29yZCkge1xuICAgICAgICAgIGNvbnN0IG1vZGVsczogUHVyZU1vZGVsfEFycmF5PFB1cmVNb2RlbD58SUlkZW50aWZpZXJ8bnVsbCA9IG1hcEl0ZW1zKFxuICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICAoZGVmOiBJRGVmaW5pdGlvbikgPT4gdGhpcy5maW5kKGRlZi50eXBlLCBkZWYuaWQpIHx8IGRlZi5pZCxcbiAgICAgICAgICApIHx8IG51bGw7XG5cbiAgICAgICAgICBjb25zdCBpdGVtVHlwZTogc3RyaW5nID0gaXRlbXMgaW5zdGFuY2VvZiBBcnJheSA/IGl0ZW1zWzBdLnR5cGUgOiBpdGVtcy50eXBlO1xuICAgICAgICAgIGlmIChyZWYgaW4gcmVjb3JkKSB7XG4gICAgICAgICAgICByZWNvcmRbcmVmXSA9IG1vZGVscztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5pdE1vZGVsUmVmKHJlY29yZCwgcmVmLCB7bW9kZWw6IGl0ZW1UeXBlLCB0eXBlOiBSZWZlcmVuY2VUeXBlLlRPX09ORV9PUl9NQU5ZfSwgbW9kZWxzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19pdGVyYXRlRW50cmllczxUIGV4dGVuZHMgSUpzb25hcGlNb2RlbD4oYm9keTogSVJlc3BvbnNlLCBmbjogKGl0ZW06IElSZWNvcmQpID0+IFQpIHtcbiAgICAgIG1hcEl0ZW1zKChib2R5ICYmIGJvZHkuaW5jbHVkZWQpIHx8IFtdLCBmbik7XG4gICAgICByZXR1cm4gbWFwSXRlbXMoKGJvZHkgJiYgYm9keS5kYXRhKSB8fCBbXSwgZm4pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19wcmVwYXJlUXVlcnkoXG4gICAgICB0eXBlOiBJVHlwZSxcbiAgICAgIGlkPzogbnVtYmVyfHN0cmluZyxcbiAgICAgIGRhdGE/OiBJUmVxdWVzdCxcbiAgICAgIG9wdGlvbnM/OiBJUmVxdWVzdE9wdGlvbnMsXG4gICAgKToge1xuICAgICAgdXJsOiBzdHJpbmcsXG4gICAgICBkYXRhPzogb2JqZWN0LFxuICAgICAgaGVhZGVyczogSUhlYWRlcnMsXG4gICAgfSB7XG4gICAgICBjb25zdCBzdGF0aWNDb2xsZWN0aW9uID0gdGhpcy5jb25zdHJ1Y3RvciBhcyB0eXBlb2YgUHVyZUNvbGxlY3Rpb247XG4gICAgICBjb25zdCBtb2RlbDogUHVyZU1vZGVsID0gc3RhdGljQ29sbGVjdGlvbi50eXBlcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0udHlwZSA9PT0gdHlwZSlbMF07XG4gICAgICBjb25zdCBwYXRoOiBzdHJpbmcgPSBtb2RlbFxuICAgICAgICA/IChnZXRWYWx1ZTxzdHJpbmc+KG1vZGVsWydlbmRwb2ludCddKSB8fCBtb2RlbFsnYmFzZVVybCddIHx8IGdldE1vZGVsVHlwZShtb2RlbCkpXG4gICAgICAgIDogdHlwZTtcblxuICAgICAgY29uc3QgdXJsOiBzdHJpbmcgPSBpZCA/IGAke3BhdGh9LyR7aWR9YCA6IGAke3BhdGh9YDtcbiAgICAgIHJldHVybiB0aGlzLl9fYnVpbGRVcmwodXJsLCBkYXRhLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9fYnVpbGRVcmwodXJsOiBzdHJpbmcsIGRhdGE/OiBJUmVxdWVzdCwgb3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucykge1xuICAgICAgY29uc3QgaGVhZGVyczogSURpY3Rpb25hcnk8c3RyaW5nPiA9IChvcHRpb25zICYmIG9wdGlvbnMuaGVhZGVycykgfHwge307XG5cbiAgICAgIGNvbnN0IHBhcmFtczogQXJyYXk8c3RyaW5nPiA9IFtcbiAgICAgICAgLi4udGhpcy5fX3ByZXBhcmVGaWx0ZXJzKChvcHRpb25zICYmIG9wdGlvbnMuZmlsdGVyKSB8fCB7fSksXG4gICAgICAgIC4uLnRoaXMuX19wcmVwYXJlU29ydChvcHRpb25zICYmIG9wdGlvbnMuc29ydCksXG4gICAgICAgIC4uLnRoaXMuX19wcmVwYXJlSW5jbHVkZXMob3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGUpLFxuICAgICAgICAuLi50aGlzLl9fcHJlcGFyZUZpZWxkcygob3B0aW9ucyAmJiBvcHRpb25zLmZpZWxkcykgfHwge30pLFxuICAgICAgICAuLi50aGlzLl9fcHJlcGFyZVJhd1BhcmFtcygob3B0aW9ucyAmJiBvcHRpb25zLnBhcmFtcykgfHwgW10pLFxuICAgICAgXTtcblxuICAgICAgY29uc3QgYmFzZVVybDogc3RyaW5nID0gdGhpcy5fX2FwcGVuZFBhcmFtcyh0aGlzLl9fcHJlZml4VXJsKHVybCksIHBhcmFtcyk7XG4gICAgICByZXR1cm4ge2RhdGEsIGhlYWRlcnMsIHVybDogYmFzZVVybH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfX3ByZXBhcmVGaWx0ZXJzKGZpbHRlcnM6IElGaWx0ZXJzKTogQXJyYXk8c3RyaW5nPiB7XG4gICAgICByZXR1cm4gdGhpcy5fX3BhcmFtZXRyaXplKGZpbHRlcnMpLm1hcCgoaXRlbSkgPT4gYGZpbHRlclske2l0ZW0ua2V5fV09JHtpdGVtLnZhbHVlfWApO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19wcmVwYXJlU29ydChzb3J0Pzogc3RyaW5nfEFycmF5PHN0cmluZz4pOiBBcnJheTxzdHJpbmc+IHtcbiAgICAgIHJldHVybiBzb3J0ID8gW2Bzb3J0PSR7c29ydH1gXSA6IFtdO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19wcmVwYXJlSW5jbHVkZXMoaW5jbHVkZT86IHN0cmluZ3xBcnJheTxzdHJpbmc+KTogQXJyYXk8c3RyaW5nPiB7XG4gICAgICByZXR1cm4gaW5jbHVkZSA/IFtgaW5jbHVkZT0ke2luY2x1ZGV9YF0gOiBbXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9fcHJlcGFyZUZpZWxkcyhmaWVsZHM6IElEaWN0aW9uYXJ5PHN0cmluZ3xBcnJheTxzdHJpbmc+Pik6IEFycmF5PHN0cmluZz4ge1xuICAgICAgY29uc3QgbGlzdDogQXJyYXk8c3RyaW5nPiA9IFtdO1xuXG4gICAgICBPYmplY3Qua2V5cyhmaWVsZHMpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBsaXN0LnB1c2goYGZpZWxkc1ske2tleX1dPSR7ZmllbGRzW2tleV19YCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfX3ByZXBhcmVSYXdQYXJhbXMocGFyYW1zOiBBcnJheTx7a2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9fHN0cmluZz4pOiBBcnJheTxzdHJpbmc+IHtcbiAgICAgIHJldHVybiBwYXJhbXMubWFwKChwYXJhbSkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHBhcmFtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBwYXJhbTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7cGFyYW0ua2V5fT0ke3BhcmFtLnZhbHVlfWA7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9fcHJlZml4VXJsKHVybCkge1xuICAgICAgaWYgKFVSTF9SRUdFWC50ZXN0KHVybCkpIHtcbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBgJHtjb25maWcuYmFzZVVybH0ke3VybH1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19hcHBlbmRQYXJhbXModXJsOiBzdHJpbmcsIHBhcmFtczogQXJyYXk8c3RyaW5nPik6IHN0cmluZyB7XG4gICAgICBpZiAocGFyYW1zLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSB1cmwuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJztcbiAgICAgICAgdXJsICs9IHNlcGFyYXRvciArIHBhcmFtcy5qb2luKCcmJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cblxuICAgIHByaXZhdGUgX19wYXJhbWV0cml6ZShwYXJhbXM6IG9iamVjdCwgc2NvcGU6IHN0cmluZyA9ICcnKSB7XG4gICAgICBjb25zdCBsaXN0OiBBcnJheTx7a2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9PiA9IFtdO1xuXG4gICAgICBPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBpZiAocGFyYW1zW2tleV0gaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgIGlmIChjb25maWcucGFyYW1BcnJheVR5cGUgPT09IFBhcmFtQXJyYXlUeXBlLk9CSkVDVF9QQVRIKSB7XG4gICAgICAgICAgICBsaXN0LnB1c2goLi4udGhpcy5fX3BhcmFtZXRyaXplKHBhcmFtc1trZXldLCBgJHtrZXl9LmApKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5wYXJhbUFycmF5VHlwZSA9PT0gUGFyYW1BcnJheVR5cGUuQ09NTUFfU0VQQVJBVEVEKSB7XG4gICAgICAgICAgICBsaXN0LnB1c2goe2tleTogYCR7c2NvcGV9JHtrZXl9YCwgdmFsdWU6IHBhcmFtc1trZXldLmpvaW4oJywnKX0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnBhcmFtQXJyYXlUeXBlID09PSBQYXJhbUFycmF5VHlwZS5NVUxUSVBMRV9QQVJBTVMpIHtcbiAgICAgICAgICAgIGxpc3QucHVzaCguLi5wYXJhbXNba2V5XS5tYXAoKHBhcmFtKSA9PiAoe2tleTogYCR7c2NvcGV9JHtrZXl9YCwgdmFsdWU6IHBhcmFtfSkpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5wYXJhbUFycmF5VHlwZSA9PT0gUGFyYW1BcnJheVR5cGUuUEFSQU1fQVJSQVkpIHtcbiAgICAgICAgICAgIGxpc3QucHVzaCguLi5wYXJhbXNba2V5XS5tYXAoKHBhcmFtKSA9PiAoe2tleTogYCR7c2NvcGV9JHtrZXl9XVtgLCB2YWx1ZTogcGFyYW19KSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGFyYW1zW2tleV0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgbGlzdC5wdXNoKC4uLnRoaXMuX19wYXJhbWV0cml6ZShwYXJhbXNba2V5XSwgYCR7a2V5fS5gKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGlzdC5wdXNoKHtrZXk6IGAke3Njb3BlfSR7a2V5fWAsIHZhbHVlOiBwYXJhbXNba2V5XX0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIEpzb25hcGlDb2xsZWN0aW9uIGFzIElDb2xsZWN0aW9uQ29uc3RydWN0b3I8UHVyZUNvbGxlY3Rpb24gJiBJSnNvbmFwaUNvbGxlY3Rpb24+O1xufVxuIl19","map":{"mappings":""},"dts":{"name":"/Users/darko/Projects/mobx/datx/packages/datx-jsonapi/decorateCollection.d.ts","text":"import { ICollectionConstructor, PureCollection } from 'datx';\r\nimport { IJsonapiCollection } from './interfaces/IJsonapiCollection';\r\nexport declare function decorateCollection(BaseClass: typeof PureCollection): ICollectionConstructor<PureCollection & IJsonapiCollection>;\r\n"}}
