{"code":"import { getModelType } from 'datx';\r\nvar cacheStorage = [];\r\nexport function saveCache(url, response, modelType) {\r\n    if ('data' in response && (!('error' in response) || !response.error) && response.data) {\r\n        // The type might need to be 100% correct - used only to clear the cache\r\n        var type = modelType || getModelType(response.data instanceof Array ? response.data[0] : response.data);\r\n        cacheStorage.push({ response: response, time: new Date(), type: type, url: url });\r\n    }\r\n}\r\nexport function getCache(url) {\r\n    return cacheStorage.find(function (item) { return item.url === url; });\r\n}\r\nexport function clearAllCache() {\r\n    cacheStorage.length = 0;\r\n}\r\nexport function clearCacheByType(type) {\r\n    cacheStorage = cacheStorage.filter(function (item) { return item.type !== type; });\r\n}\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FjaGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzcmMvY2FjaGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFlBQVksRUFBUSxNQUFNLE1BQU0sQ0FBQztBQWF6QyxJQUFJLFlBQVksR0FBa0IsRUFBRSxDQUFDO0FBRXJDLE1BQU0sb0JBQW9CLEdBQVcsRUFBRSxRQUFpQyxFQUFFLFNBQWtCO0lBQzFGLElBQUksTUFBTSxJQUFJLFFBQVEsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksRUFBRTtRQUN0Rix3RUFBd0U7UUFDeEUsSUFBTSxJQUFJLEdBQUcsU0FBUyxJQUFJLFlBQVksQ0FBQyxRQUFRLENBQUMsSUFBSSxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFHLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBQyxRQUFRLFVBQUEsRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsRUFBRSxJQUFJLE1BQUEsRUFBRSxHQUFHLEtBQUEsRUFBQyxDQUFDLENBQUM7S0FDNUQ7QUFDSCxDQUFDO0FBRUQsTUFBTSxtQkFBbUIsR0FBVztJQUNsQyxPQUFPLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsR0FBRyxLQUFLLEdBQUcsRUFBaEIsQ0FBZ0IsQ0FBQyxDQUFDO0FBQ3ZELENBQUM7QUFFRCxNQUFNO0lBQ0osWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUVELE1BQU0sMkJBQTJCLElBQVc7SUFDMUMsWUFBWSxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsSUFBSSxLQUFLLElBQUksRUFBbEIsQ0FBa0IsQ0FBQyxDQUFDO0FBQ25FLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2dldE1vZGVsVHlwZSwgSVR5cGV9IGZyb20gJ2RhdHgnO1xuaW1wb3J0IHtJRGljdGlvbmFyeX0gZnJvbSAnZGF0eC11dGlscyc7XG5cbmltcG9ydCB7SUpzb25hcGlNb2RlbH0gZnJvbSAnLi9pbnRlcmZhY2VzL0lKc29uYXBpTW9kZWwnO1xuaW1wb3J0IHtSZXNwb25zZX0gZnJvbSAnLi9SZXNwb25zZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhY2hlIHtcbiAgcmVzcG9uc2U6IFJlc3BvbnNlPElKc29uYXBpTW9kZWw+O1xuICB0aW1lOiBEYXRlO1xuICB0eXBlOiBJVHlwZTtcbiAgdXJsOiBzdHJpbmc7XG59XG5cbmxldCBjYWNoZVN0b3JhZ2U6IEFycmF5PElDYWNoZT4gPSBbXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVDYWNoZSh1cmw6IHN0cmluZywgcmVzcG9uc2U6IFJlc3BvbnNlPElKc29uYXBpTW9kZWw+LCBtb2RlbFR5cGU/OiBzdHJpbmcpIHtcbiAgaWYgKCdkYXRhJyBpbiByZXNwb25zZSAmJiAoISgnZXJyb3InIGluIHJlc3BvbnNlKSB8fCAhcmVzcG9uc2UuZXJyb3IpICYmIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAvLyBUaGUgdHlwZSBtaWdodCBuZWVkIHRvIGJlIDEwMCUgY29ycmVjdCAtIHVzZWQgb25seSB0byBjbGVhciB0aGUgY2FjaGVcbiAgICBjb25zdCB0eXBlID0gbW9kZWxUeXBlIHx8IGdldE1vZGVsVHlwZShyZXNwb25zZS5kYXRhIGluc3RhbmNlb2YgQXJyYXkgPyByZXNwb25zZS5kYXRhWzBdIDogcmVzcG9uc2UuZGF0YSk7XG4gICAgY2FjaGVTdG9yYWdlLnB1c2goe3Jlc3BvbnNlLCB0aW1lOiBuZXcgRGF0ZSgpLCB0eXBlLCB1cmx9KTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FjaGUodXJsOiBzdHJpbmcpOiBJQ2FjaGV8dW5kZWZpbmVkIHtcbiAgcmV0dXJuIGNhY2hlU3RvcmFnZS5maW5kKChpdGVtKSA9PiBpdGVtLnVybCA9PT0gdXJsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyQWxsQ2FjaGUoKSB7XG4gIGNhY2hlU3RvcmFnZS5sZW5ndGggPSAwO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJDYWNoZUJ5VHlwZSh0eXBlOiBJVHlwZSkge1xuICBjYWNoZVN0b3JhZ2UgPSBjYWNoZVN0b3JhZ2UuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnR5cGUgIT09IHR5cGUpO1xufVxuIl19","dts":{"name":"/Users/darko/Projects/mobx/datx/packages/datx-jsonapi/cache.d.ts","text":"import { IType } from 'datx';\r\nimport { IJsonapiModel } from './interfaces/IJsonapiModel';\r\nimport { Response } from './Response';\r\nexport interface ICache {\r\n    response: Response<IJsonapiModel>;\r\n    time: Date;\r\n    type: IType;\r\n    url: string;\r\n}\r\nexport declare function saveCache(url: string, response: Response<IJsonapiModel>, modelType?: string): void;\r\nexport declare function getCache(url: string): ICache | undefined;\r\nexport declare function clearAllCache(): void;\r\nexport declare function clearCacheByType(type: IType): void;\r\n"}}
